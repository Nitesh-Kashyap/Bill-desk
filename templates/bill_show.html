{% extends "base.html" %}
{% block content %}
<h3 class="mb-3">Invoice #{{ bill.id }}</h3>

<div class="table-responsive mb-3">
  <table class="table table-bordered align-middle">
    <thead>
      <tr>
        <th>Item</th><th>Price</th><th>Qty</th><th>Line Total</th>
      </tr>
    </thead>
    <tbody>
      {% for it in items %}
      <tr>
        <td>{{ it.name }}</td>
        <td>{{ '%.2f'|format(it.price) }}</td>
        <td>{{ it.quantity }}</td>
        <td>{{ '%.2f'|format(it.line_total) }}</td>
      </tr>
      {% endfor %}
    </tbody>
    <tfoot>
      <tr>
        <th colspan="3" class="text-end">Subtotal</th>
        <th>{{ '%.2f'|format(bill.subtotal) }}</th>
      </tr>
      <tr>
        <th colspan="3" class="text-end">
          {% if bill.discount_type == 'percent' %}Discount ({{ '%.2f'|format(bill.discount_value) }}%){% else %}Discount{% endif %}
        </th>
        <th>
          {% if bill.discount_type == 'percent' %}
            {{ '%.2f'|format((bill.discount_value/100.0) * bill.subtotal) }}
          {% else %}
            {{ '%.2f'|format(bill.discount_value) }}
          {% endif %}
        </th>
      </tr>
      <tr>
        <th colspan="3" class="text-end">Grand Total</th>
        <th>{{ '%.2f'|format(bill.total) }}</th>
      </tr>
    </tfoot>
  </table>
</div>

{% if pdf_exists %}
  <a class="btn btn-primary" href="{{ url_for('download_pdf', filename=filename) }}">Download PDF</a>
{% else %}
  <div class="alert alert-warning">PDF file not found.</div>
{% endif %}
<a class="btn btn-outline-secondary" href="{{ url_for('bills') }}">Back to Bills</a>
{% endblock %}
